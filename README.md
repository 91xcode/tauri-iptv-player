# IPTV Player

ä¸€ä¸ªåŸºäº Tauri + React çš„**å…¨å¹³å°** IPTV æ’­æ”¾å™¨ï¼Œä¸“ä¸ºç¨³å®šæ’­æ”¾ç›´æ’­æµè€Œä¼˜åŒ–ã€‚

## ğŸŒ æ”¯æŒå¹³å°

| å¹³å° | æ¶æ„ | å®‰è£…åŒ…æ ¼å¼ | çŠ¶æ€ |
|------|------|-----------|------|
| **macOS** | Apple Silicon (M1/M2/M3) | `.dmg` | âœ… å®Œå…¨æ”¯æŒ |
| **macOS** | Intel (x86_64) | `.dmg` | âœ… å®Œå…¨æ”¯æŒ |
| **Windows** | x64 | `.msi`, `.exe` | âœ… å®Œå…¨æ”¯æŒ |
| **Linux** | x64 | `.deb`, `.AppImage` | âœ… å®Œå…¨æ”¯æŒ |

## âœ¨ ç‰¹æ€§

- ğŸ“º æ”¯æŒ M3U/M3U8 æ’­æ”¾åˆ—è¡¨
- ğŸ¬ æ”¯æŒ HLS ç›´æ’­æµæ’­æ”¾ï¼ˆå®Œå…¨å…¼å®¹ IPv6ï¼‰
- ğŸŒ å†…ç½® HTTP ä»£ç†æœåŠ¡å™¨ï¼ˆ`http://127.0.0.1:18080`ï¼‰
- ğŸ”„ æ™ºèƒ½ URL é‡å†™ï¼ˆè‡ªåŠ¨å¤„ç† IPv6ã€ç›¸å¯¹è·¯å¾„ã€æ··åˆå†…å®¹ï¼‰
- ğŸ“± ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢
- ğŸ”„ è®¢é˜…æºç®¡ç†
- ğŸ“‹ é¢‘é“åˆ—è¡¨å±•ç¤º
- ğŸ¯ è½»é‡çº§æ‰“åŒ…ï¼ˆ3-10MBï¼‰
- âš¡ é«˜æ€§èƒ½ã€ä½å†…å­˜å ç”¨
- ğŸ›¡ï¸ ç¨³å®šçš„é•¿æ—¶é—´æ’­æ”¾ï¼ˆæ”¯æŒè¶…è¿‡ 1 å°æ—¶çš„è¿ç»­ç›´æ’­ï¼‰
- ğŸŒ **å…¨å¹³å°æ”¯æŒ**ï¼ˆmacOS, Windows, Linuxï¼‰

## ğŸ“¥ ä¸‹è½½å®‰è£…

### ä» GitHub Releases ä¸‹è½½

è®¿é—® [Releases é¡µé¢](https://github.com/91xcode/tauri-iptv-player/releases) ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼š

**macOS**:
- Apple Silicon (M1/M2/M3): `IPTV-Player-v*-macOS-Apple-Silicon.dmg`
- Intel: `IPTV-Player-v*-macOS-Intel.dmg`
- å®‰è£…: åŒå‡» `.dmg`ï¼Œæ‹–æ‹½åˆ° Applications

**Windows**:
- `IPTV-Player-v*-Windows-x64.msi` (æ¨è)
- `IPTV-Player-v*-Windows-x64-setup.exe` (NSIS å®‰è£…å™¨)
- å®‰è£…: åŒå‡»è¿è¡Œå®‰è£…ç¨‹åº

**Linux**:
- Debian/Ubuntu: `IPTV-Player-v*-Linux-x64.deb`
  ```bash
  sudo dpkg -i IPTV-Player-v*-Linux-x64.deb
  ```
- é€šç”¨æ ¼å¼: `IPTV-Player-v*-Linux-x64.AppImage`
  ```bash
  chmod +x IPTV-Player-v*-Linux-x64.AppImage
  ./IPTV-Player-v*-Linux-x64.AppImage
  ```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¼€å‘ç¯å¢ƒ

#### å‰ç½®è¦æ±‚

1. **Node.js** (v16+)
2. **Rust** (å®‰è£…å‘½ä»¤: `curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh`)
3. **ç³»ç»Ÿä¾èµ–**:
   - macOS: æ— éœ€é¢å¤–ä¾èµ–
   - Linux: `sudo apt install libwebkit2gtk-4.0-dev build-essential curl wget file libssl-dev libayatana-appindicator3-dev librsvg2-dev`
   - Windows: å®‰è£… WebView2

#### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
cd iptv-player
npm install
npm run tauri dev
```

### ç”Ÿäº§æ‰“åŒ…

#### ğŸ“¦ æ‰“åŒ…å‰å‡†å¤‡

1. **æ¸…ç†æ—§çš„æ„å»ºäº§ç‰©**
   ```bash
   cd /Users/sai/good_tool/palyer/iptv-player
   rm -rf src-tauri/target/release/bundle
   ```

2. **ç¡®è®¤ä¾èµ–å·²å®‰è£…**
   ```bash
   npm install
   ```

3. **ä¿®å¤ TypeScript é”™è¯¯ï¼ˆå¦‚éœ€è¦ï¼‰**
   ```bash
   npm run build  # æµ‹è¯•å‰ç«¯æ„å»º
   ```

#### ğŸ”¨ å¼€å§‹æ‰“åŒ…

**æ–¹æ³• 1ï¼šç›´æ¥æ‰“åŒ…ï¼ˆæ¨èï¼‰**
```bash
npm run tauri build
```

**æ–¹æ³• 2ï¼šåå°æ‰“åŒ…ï¼ˆé•¿æ—¶é—´ä»»åŠ¡ï¼‰**
```bash
npm run tauri build > /tmp/tauri-build.log 2>&1 &

# æŸ¥çœ‹æ„å»ºè¿›åº¦
tail -f /tmp/tauri-build.log

# æˆ–ä½¿ç”¨æä¾›çš„ç›‘æ§è„šæœ¬
./check-build.sh
```

#### ğŸ“ æ‰“åŒ…äº§ç‰©ä½ç½®

æ‰“åŒ…æˆåŠŸåï¼Œæ–‡ä»¶ä½äºï¼š

**macOS**
```
src-tauri/target/release/bundle/macos/
â”œâ”€â”€ IPTV Player.app                    # åº”ç”¨ç¨‹åºåŒ…
â””â”€â”€ IPTV Player_0.1.0_aarch64.dmg     # DMG å®‰è£…åŒ…ï¼ˆæ¨èåˆ†å‘ï¼‰
```

**Windows** (åœ¨ Windows ç³»ç»Ÿä¸Šæ„å»º)
```
src-tauri/target/release/bundle/msi/
â””â”€â”€ IPTV Player_0.1.0_x64_en-US.msi   # MSI å®‰è£…åŒ…

src-tauri/target/release/bundle/nsis/
â””â”€â”€ IPTV Player_0.1.0_x64-setup.exe   # NSIS å®‰è£…åŒ…
```

**Linux** (åœ¨ Linux ç³»ç»Ÿä¸Šæ„å»º)
```
src-tauri/target/release/bundle/deb/
â””â”€â”€ iptv-player_0.1.0_amd64.deb       # Debian åŒ…

src-tauri/target/release/bundle/appimage/
â””â”€â”€ iptv-player_0.1.0_amd64.AppImage  # AppImage åŒ…
```

#### ğŸ“¦ æ•´ç†å‘å¸ƒåŒ…

é¡¹ç›®æä¾›äº†è‡ªåŠ¨æ•´ç†è„šæœ¬ï¼Œä¼šå°†å®‰è£…åŒ…å¤åˆ¶åˆ° `releases/` ç›®å½•ï¼š

```bash
# è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»º releases ç›®å½•å¹¶é‡å‘½åæ–‡ä»¶
mkdir -p releases
cp "src-tauri/target/release/bundle/macos/IPTV Player_0.1.0_aarch64.dmg" \
   "releases/IPTV-Player-v0.1.0-macOS-Apple-Silicon.dmg"
```

é‡å‘½ååçš„æ–‡ä»¶ï¼š
- macOS (Apple Silicon): `IPTV-Player-v0.1.0-macOS-Apple-Silicon.dmg`
- macOS (Intel): `IPTV-Player-v0.1.0-macOS-Intel.dmg`
- Windows: `IPTV-Player-v0.1.0-Windows-x64.msi`
- Linux: `IPTV-Player-v0.1.0-Linux-x64.deb`

#### ğŸš€ åˆ†å‘å®‰è£…åŒ…

**åˆ†äº«ç»™å…¶ä»–ç”¨æˆ·ï¼š**
1. ä¸Šä¼ åˆ°äº‘ç›˜ï¼ˆç™¾åº¦ç½‘ç›˜ã€é˜¿é‡Œäº‘ç›˜ç­‰ï¼‰
2. å‘å¸ƒåˆ° GitHub Releases
3. æ‰˜ç®¡åˆ°è‡ªå·±çš„æœåŠ¡å™¨

**ç”¨æˆ·å®‰è£…æ­¥éª¤ï¼ˆmacOSï¼‰ï¼š**
1. ä¸‹è½½ `.dmg` æ–‡ä»¶
2. åŒå‡»æ‰“å¼€ DMG
3. æ‹–æ‹½ "IPTV Player.app" åˆ° "Applications" æ–‡ä»¶å¤¹
4. é¦–æ¬¡è¿è¡Œï¼šå³é”®ç‚¹å‡» â†’ "æ‰“å¼€" â†’ åœ¨å¼¹çª—ä¸­å†æ¬¡ç‚¹å‡» "æ‰“å¼€"

#### âš™ï¸ æ„å»ºè„šæœ¬è¯´æ˜

é¡¹ç›®åŒ…å«ä»¥ä¸‹æ„å»ºç›¸å…³è„šæœ¬ï¼š

**1. `check-build.sh` - æ„å»ºç›‘æ§è„šæœ¬**
```bash
#!/bin/bash
# è‡ªåŠ¨ç›‘æ§æ„å»ºè¿›åº¦ï¼Œæ˜¾ç¤ºå®æ—¶æ—¥å¿—
# æ„å»ºå®Œæˆåè‡ªåŠ¨æŸ¥æ‰¾ç”Ÿæˆçš„å®‰è£…åŒ…

chmod +x check-build.sh
./check-build.sh
```

**åŠŸèƒ½ï¼š**
- â³ å®æ—¶æ˜¾ç¤ºç¼–è¯‘è¿›åº¦
- ğŸ“¦ è‡ªåŠ¨æ£€æµ‹æ‰“åŒ…çŠ¶æ€
- ğŸ“ æ„å»ºå®Œæˆååˆ—å‡ºæ‰€æœ‰ç”Ÿæˆçš„å®‰è£…åŒ…
- ğŸ“„ æ˜¾ç¤ºæœ€å 20 è¡Œæ„å»ºæ—¥å¿—

**2. æ„å»ºæ—¶é—´å‚è€ƒ**

| å¹³å° | é¦–æ¬¡æ„å»º | å¢é‡æ„å»º | è¯´æ˜ |
|------|---------|---------|------|
| macOS (M1/M2/M3) | 5-10 åˆ†é’Ÿ | 2-5 åˆ†é’Ÿ | Rust ä¾èµ–ç¼–è¯‘è¾ƒæ…¢ |
| Windows | 8-15 åˆ†é’Ÿ | 3-6 åˆ†é’Ÿ | éœ€è¦é¢å¤–ç¼–è¯‘ WebView2 |
| Linux | 6-12 åˆ†é’Ÿ | 2-5 åˆ†é’Ÿ | å–å†³äºç³»ç»Ÿé…ç½® |

**3. æ„å»ºä¼˜åŒ–å»ºè®®**

**åŠ é€Ÿé¦–æ¬¡æ„å»ºï¼š**
```bash
# ä½¿ç”¨å›½å†… Rust é•œåƒ
export RUSTUP_DIST_SERVER="https://rsproxy.cn"
export RUSTUP_UPDATE_ROOT="https://rsproxy.cn/rustup"

# æˆ–ç¼–è¾‘ ~/.cargo/config.toml
[source.crates-io]
replace-with = 'tuna'

[source.tuna]
registry = "https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git"
```

**å¢é‡æ„å»ºï¼ˆè·³è¿‡ä¾èµ–é‡æ–°ç¼–è¯‘ï¼‰ï¼š**
```bash
# åªæœ‰ä»£ç ä¿®æ”¹æ—¶ä½¿ç”¨
npm run tauri build -- --no-bundle  # ä»…ç¼–è¯‘ï¼Œä¸æ‰“åŒ…
```

#### ğŸ› æ‰“åŒ…å¸¸è§é—®é¢˜

**1. TypeScript ç¼–è¯‘é”™è¯¯**
```bash
# é”™è¯¯: error TS6133: 'xxx' is declared but its value is never read
# è§£å†³: æ·»åŠ  @ts-ignore æ³¨é‡Šæˆ–ç§»é™¤æœªä½¿ç”¨çš„å¯¼å…¥

# ç¤ºä¾‹ä¿®å¤
// @ts-ignore - ä¿ç•™ç”¨äºæœªæ¥åŠŸèƒ½
import { invoke } from "@tauri-apps/api/core";
```

**2. Rust ç¼–è¯‘é”™è¯¯**
```bash
# é”™è¯¯: missing field 'xxx' in initializer
# è§£å†³: æ£€æŸ¥ç»“æ„ä½“å®šä¹‰ï¼Œç¡®ä¿æ‰€æœ‰å­—æ®µéƒ½å·²åˆå§‹åŒ–

# æ¸…ç†å¹¶é‡æ–°æ„å»º
cargo clean
npm run tauri build
```

**3. æ‰“åŒ…ä½“ç§¯è¿‡å¤§**
```bash
# ä¼˜åŒ–æ„å»ºï¼ˆç”Ÿäº§æ¨¡å¼å·²é»˜è®¤å¯ç”¨ï¼‰
# Cargo.toml ä¸­é…ç½®ï¼š
[profile.release]
opt-level = "z"     # ä¼˜åŒ–ä½“ç§¯
lto = true          # é“¾æ¥æ—¶ä¼˜åŒ–
codegen-units = 1   # å•ä¸ªç¼–è¯‘å•å…ƒ
strip = true        # ç§»é™¤ç¬¦å·ä¿¡æ¯
```

**4. ç«¯å£å†²çªå¯¼è‡´æ‰“åŒ…å¤±è´¥**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i:1420   # Vite å¼€å‘æœåŠ¡å™¨
lsof -i:18080  # ä»£ç†æœåŠ¡å™¨

# æ€æ­»å ç”¨è¿›ç¨‹
lsof -ti:1420 | xargs kill -9
lsof -ti:18080 | xargs kill -9
```

**5. macOS æ‰“åŒ…åæ— æ³•æ‰“å¼€**
```bash
# ç§»é™¤éš”ç¦»å±æ€§
xattr -cr "/Applications/IPTV Player.app"

# æˆ–åœ¨ç³»ç»Ÿè®¾ç½®ä¸­å…è®¸
ç³»ç»Ÿè®¾ç½® â†’ éšç§ä¸å®‰å…¨æ€§ â†’ ä»è¦æ‰“å¼€
```

#### ğŸ“Š ç‰ˆæœ¬å·ç®¡ç†

**ä¿®æ”¹ç‰ˆæœ¬å·ï¼š**

1. **ä¿®æ”¹ package.json**
   ```json
   {
     "version": "0.2.0"
   }
   ```

2. **ä¿®æ”¹ src-tauri/Cargo.toml**
   ```toml
   [package]
   version = "0.2.0"
   ```

3. **ä¿®æ”¹ src-tauri/tauri.conf.json**
   ```json
   {
     "version": "0.2.0"
   }
   ```

**é‡æ–°æ‰“åŒ…ï¼š**
```bash
npm run tauri build
```

ç”Ÿæˆçš„æ–‡ä»¶åä¼šè‡ªåŠ¨åŒ…å«æ–°ç‰ˆæœ¬å·ï¼š
- `IPTV Player_0.2.0_aarch64.dmg`

#### ğŸ¯ CI/CD è‡ªåŠ¨åŒ–æ‰“åŒ…

å¦‚æœä½¿ç”¨ GitHub Actionsï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®ï¼š

```yaml
name: Build Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    strategy:
      matrix:
        platform: [macos-latest, ubuntu-latest, windows-latest]

    runs-on: ${{ matrix.platform }}

    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Setup Rust
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable

      - name: Install dependencies
        run: npm install

      - name: Build Tauri app
        run: npm run tauri build

      - name: Upload artifacts
        uses: actions/upload-artifact@v3
        with:
          name: ${{ matrix.platform }}-build
          path: src-tauri/target/release/bundle/
```

## ğŸ“– ä½¿ç”¨è¯´æ˜

### 1. æ·»åŠ è®¢é˜…æº

ç‚¹å‡»å·¦ä¾§è¾¹æ çš„ **â•** æŒ‰é’®ï¼Œè¾“å…¥:
- **è®¢é˜…æºåç§°**: ä¾‹å¦‚ "CCTV é¢‘é“"
- **è®¢é˜…æºåœ°å€**: M3U/M3U8 æ’­æ”¾åˆ—è¡¨ URL

æˆ–ç‚¹å‡» **"ä½¿ç”¨æµ‹è¯•åœ°å€"** æŒ‰é’®ä½¿ç”¨å†…ç½®æµ‹è¯•æºã€‚

### 2. é€‰æ‹©é¢‘é“

- ç‚¹å‡»å·¦ä¾§è®¢é˜…æºæŸ¥çœ‹é¢‘é“åˆ—è¡¨
- ç‚¹å‡»é¢‘é“å¼€å§‹æ’­æ”¾

### 3. æµ‹è¯•åœ°å€

```
https://upyun.luckly-mjw.cn/Assets/media-source/example/media/index.m3u8
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **React 19** - UI æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨
- **Vite** - æ„å»ºå·¥å…·
- **HLS.js 1.5+** - HLS æµæ’­æ”¾å™¨
  - ä¼˜åŒ–çš„è¶…æ—¶é…ç½®ï¼ˆ60 ç§’ç‰‡æ®µåŠ è½½è¶…æ—¶ï¼‰
  - æ™ºèƒ½é”™è¯¯è¿‡æ»¤å’Œè‡ªåŠ¨æ¢å¤
  - å¤§å®¹é‡ç¼“å†²åŒºï¼ˆ30-60 ç§’ï¼‰
  - æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶

### åç«¯
- **Rust** - ç³»ç»Ÿè¯­è¨€
- **Tauri 2** - æ¡Œé¢åº”ç”¨æ¡†æ¶
- **Axum 0.7** - HTTP ä»£ç†æœåŠ¡å™¨æ¡†æ¶
- **Reqwest 0.12** - HTTP å®¢æˆ·ç«¯ï¼ˆæ”¯æŒ IPv6ï¼‰
- **Tower-HTTP** - CORS ä¸­é—´ä»¶

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
iptv-player/
â”œâ”€â”€ src/                          # React å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ components/               # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ VideoPlayer.tsx       # è§†é¢‘æ’­æ”¾å™¨ â­ æ ¸å¿ƒ
â”‚   â”‚   â”‚                         # - HLS.js é…ç½®ä¼˜åŒ–
â”‚   â”‚   â”‚                         # - IPv6 URL å¤„ç†
â”‚   â”‚   â”‚                         # - æ™ºèƒ½é”™è¯¯æ¢å¤
â”‚   â”‚   â”œâ”€â”€ ChannelList.tsx       # é¢‘é“åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ SourceList.tsx        # è®¢é˜…æºåˆ—è¡¨
â”‚   â”‚   â””â”€â”€ AddSource.tsx         # æ·»åŠ è®¢é˜…æºå¯¹è¯æ¡†
â”‚   â”œâ”€â”€ App.tsx                   # ä¸»åº”ç”¨
â”‚   â””â”€â”€ App.css                   # æ ·å¼
â”œâ”€â”€ src-tauri/                    # Rust åç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ lib.rs                # Tauri æ ¸å¿ƒé€»è¾‘ â­ æ ¸å¿ƒ
â”‚   â”‚   â”‚                         # - HTTP ä»£ç†æœåŠ¡å™¨ï¼ˆAxumï¼‰
â”‚   â”‚   â”‚                         # - m3u8 URL é‡å†™
â”‚   â”‚   â”‚                         # - M3U è§£æå™¨
â”‚   â”‚   â”‚                         # - æ•°æ®æŒä¹…åŒ–
â”‚   â”‚   â””â”€â”€ main.rs               # ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ Cargo.toml                # Rust ä¾èµ–
â”‚   â”‚                             # - axum (HTTP æœåŠ¡å™¨)
â”‚   â”‚                             # - reqwest (HTTP å®¢æˆ·ç«¯)
â”‚   â”‚                             # - tower-http (CORS)
â”‚   â””â”€â”€ tauri.conf.json           # Tauri é…ç½®
â”œâ”€â”€ package.json                  # Node.js ä¾èµ–
â”œâ”€â”€ ä¿®å¤æ€»ç»“.md                   # æŠ€æœ¯ä¿®å¤è®°å½•
â””â”€â”€ README.md                     # æœ¬æ–‡æ¡£
```

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (React + HLS.js)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  VideoPlayer   â”‚  â”‚ ChannelList  â”‚  â”‚  SourceList     â”‚  â”‚
â”‚  â”‚  - HLS.js é…ç½® â”‚  â”‚ - é¢‘é“å±•ç¤º   â”‚  â”‚  - è®¢é˜…æºç®¡ç†   â”‚  â”‚
â”‚  â”‚  - é”™è¯¯å¤„ç†    â”‚  â”‚ - æœç´¢è¿‡æ»¤   â”‚  â”‚  - æ·»åŠ /åˆ é™¤    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                    â”‚                  â”‚           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                â”‚                              â”‚
â”‚                    Tauri Bridge (IPC)                         â”‚
â”‚                                â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åç«¯ (Rust + Tauri)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          Axum HTTP ä»£ç†æœåŠ¡å™¨ (127.0.0.1:18080)         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  1. æ¥æ”¶ä»£ç†è¯·æ±‚                                  â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  2. é€šè¿‡ Reqwest è·å–åŸå§‹ m3u8/ts               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  3. å¦‚æœæ˜¯ m3u8ï¼Œé‡å†™æ‰€æœ‰ URLï¼š                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚     - ç›¸å¯¹è·¯å¾„ â†’ ç»å¯¹è·¯å¾„                       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚     - IPv6 URL â†’ ä»£ç† URL                       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  4. æ·»åŠ  CORS å¤´å’Œæµè§ˆå™¨ User-Agent            â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  5. è¿”å›å¤„ç†åçš„å†…å®¹                            â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Tauri å‘½ä»¤å¤„ç†å™¨                           â”‚  â”‚
â”‚  â”‚  - get_sources: è·å–è®¢é˜…æºåˆ—è¡¨                         â”‚  â”‚
â”‚  â”‚  - add_source: æ·»åŠ æ–°è®¢é˜…æº (è§£æ M3U)                 â”‚  â”‚
â”‚  â”‚  - delete_source: åˆ é™¤è®¢é˜…æº                          â”‚  â”‚
â”‚  â”‚  - fetch_url_content: è·å–è¿œç¨‹å†…å®¹                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              æ•°æ®æŒä¹…åŒ– (JSON)                          â”‚  â”‚
â”‚  â”‚  è·¯å¾„: ~/Library/Application Support/com.sai.iptv-player â”‚
â”‚  â”‚  æ–‡ä»¶: sources.json                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ Reqwest (æ”¯æŒ IPv6)
                                 â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   IPTV ç›´æ’­æºæœåŠ¡å™¨   â”‚
                      â”‚  (IPv4 / IPv6)       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ†š ä¸ x-iptv-player æŠ€æœ¯å¯¹æ¯”

æœ¬é¡¹ç›®å‚è€ƒäº† **x-iptv-player** (Electron) çš„æœ€ä½³å®è·µï¼Œå¹¶ç”¨ Tauri é‡æ–°å®ç°ï¼š

| ç‰¹æ€§ | x-iptv-player (Electron) | æœ¬é¡¹ç›® (Tauri) | è¯´æ˜ |
|------|-------------------------|----------------|------|
| **æ¡Œé¢æ¡†æ¶** | Electron | Tauri 2 | Tauri æ‰“åŒ…æ›´å° (3MB vs 100MB+) |
| **åç«¯è¯­è¨€** | Node.js | Rust | Rust æ€§èƒ½æ›´é«˜ï¼Œå†…å­˜å ç”¨æ›´ä½ |
| **HTTP ä»£ç†** | Node.js `http.createServer` | Axum (Rust) | ä¸¤è€…éƒ½åœ¨ `127.0.0.1` å›ºå®šç«¯å£ |
| **ä»£ç†ç«¯å£** | åŠ¨æ€ç«¯å£ | 18080 å›ºå®šç«¯å£ | Tauri ç‰ˆä½¿ç”¨å›ºå®šç«¯å£é¿å…é…ç½® |
| **m3u8 é‡å†™** | âœ… åœ¨ä»£ç†æœåŠ¡å™¨ä¸­ | âœ… åœ¨ä»£ç†æœåŠ¡å™¨ä¸­ | å®Œå…¨ä¸€è‡´çš„å®ç°é€»è¾‘ |
| **HLS.js é…ç½®** | æ ‡å‡†é…ç½® | ä¼˜åŒ–é…ç½® | è¶…æ—¶å¢åŠ ã€é‡è¯•å¢åŠ ã€buffer å¢åŠ  |
| **é”™è¯¯å¤„ç†** | åŸºç¡€å¤„ç† | æ™ºèƒ½è¿‡æ»¤ + æŒ‡æ•°é€€é¿ | Tauri ç‰ˆæ›´å¥å£® |
| **Session å¤´æ³¨å…¥** | âœ… Electron session API | âš ï¸ é€šè¿‡ä»£ç†æ³¨å…¥ | ä¸¤ç§ä¸åŒçš„å®ç°æ–¹å¼ |
| **æ’­æ”¾ç›‘æ§** | âŒ æ—  | âŒ æ— ï¼ˆå·²ç§»é™¤ï¼‰ | éƒ½è®© HLS.js è‡ªå·±å¤„ç† |
| **IPv6 æ”¯æŒ** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | å®Œå…¨ä¸€è‡´ |
| **æ‰“åŒ…ä½“ç§¯** | ~100MB+ | ~3-10MB | Tauri ä¼˜åŠ¿æ˜æ˜¾ |
| **å†…å­˜å ç”¨** | ~150-300MB | ~50-100MB | Rust ä¼˜åŠ¿ |

**æ ¸å¿ƒå€Ÿé‰´ç‚¹ï¼š**
1. âœ… **ä»£ç†æœåŠ¡å™¨æ¨¡å¼** - å®Œå…¨ç›¸åŒçš„æ¶æ„
2. âœ… **m3u8 URL é‡å†™** - å®Œå…¨ç›¸åŒçš„ç®—æ³•
3. âœ… **ç®€æ´çš„æ’­æ”¾é€»è¾‘** - ä¸å¹²é¢„ HLS.jsï¼Œè®©å…¶è‡ªåŠ¨å¤„ç†
4. âœ… **è¯·æ±‚å¤´æ³¨å…¥** - User-Agentã€Refererã€CORS ç­‰

**æ”¹è¿›ç‚¹ï¼š**
1. ğŸš€ **æ€§èƒ½æ›´ä¼˜** - Rust åç«¯ + Tauri æ¡†æ¶
2. ğŸ“¦ **ä½“ç§¯æ›´å°** - 3MB vs 100MB+
3. ğŸ›¡ï¸ **æ›´å¥å£®çš„é”™è¯¯å¤„ç†** - æ™ºèƒ½è¿‡æ»¤ + æŒ‡æ•°é€€é¿é‡è¯•
4. âš¡ **æ›´å¤§çš„ç¼“å†²åŒº** - 30-60 ç§’ buffer

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### å·²å®ç°
- âœ… M3U/M3U8 æ’­æ”¾åˆ—è¡¨è§£æ
- âœ… HLS è§†é¢‘æµæ’­æ”¾ï¼ˆå®Œå…¨æ”¯æŒç›´æ’­æµï¼‰
- âœ… IPv6 URL å®Œç¾æ”¯æŒï¼ˆè‡ªåŠ¨ä»£ç†ï¼‰
- âœ… æœ¬åœ° HTTP ä»£ç†æœåŠ¡å™¨ï¼ˆAxumï¼‰
- âœ… æ™ºèƒ½ m3u8 URL é‡å†™
- âœ… è®¢é˜…æºç®¡ç†ï¼ˆæ·»åŠ /åˆ é™¤ï¼‰
- âœ… é¢‘é“åˆ—è¡¨å±•ç¤º
- âœ… è§†é¢‘æ’­æ”¾æ§åˆ¶
- âœ… macOS DMG æ‰“åŒ…
- âœ… é•¿æ—¶é—´ç¨³å®šæ’­æ”¾ï¼ˆè¶…è¿‡ 1 å°æ—¶æ— ä¸­æ–­ï¼‰
- âœ… æ™ºèƒ½é”™è¯¯æ¢å¤ï¼ˆè‡ªåŠ¨é‡è¯•å’Œé™çº§ï¼‰
- âœ… æ•°æ®æŒä¹…åŒ–ï¼ˆæœ¬åœ° JSON å­˜å‚¨ï¼‰

### è®¡åˆ’ä¸­
- ğŸ”² é¢‘é“æ”¶è—åŠŸèƒ½
- ğŸ”² æ’­æ”¾å†å²è®°å½•
- ğŸ”² é¢‘é“æœç´¢
- ğŸ”² é¢‘é“åˆ†ç±»
- ğŸ”² ç”»è´¨é€‰æ‹©
- ğŸ”² å­—å¹•æ”¯æŒ

## ğŸ¥ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. IPv6 URL å¤„ç†

é¡¹ç›®å®Œç¾æ”¯æŒ IPv6 ç›´æ’­æµï¼ˆå¦‚ `http://[2409:8087:8:21::18]:6610/...`ï¼‰ï¼š

**å·¥ä½œæµç¨‹ï¼š**
```
1. å‰ç«¯æ£€æµ‹ IPv6 URL
   â†“
2. é€šè¿‡æœ¬åœ°ä»£ç†è®¿é—®: http://127.0.0.1:18080/proxy?url=åŸå§‹URL
   â†“
3. Rust ä»£ç†æœåŠ¡å™¨è·å– m3u8 å†…å®¹
   â†“
4. æ™ºèƒ½é‡å†™ m3u8 ä¸­çš„æ‰€æœ‰ URLï¼ˆç›¸å¯¹è·¯å¾„ â†’ ç»å¯¹è·¯å¾„ â†’ ä»£ç† URLï¼‰
   â†“
5. è¿”å›å¤„ç†åçš„ m3u8 ç»™ HLS.js
   â†“
6. HLS.js è§£æå¹¶è¯·æ±‚ .ts ç‰‡æ®µï¼ˆä¹Ÿé€šè¿‡ä»£ç†ï¼‰
   â†“
7. âœ… æŒç»­ç¨³å®šæ’­æ”¾
```

**å…³é”®ä»£ç ä½ç½®ï¼š**
- å‰ç«¯ URL å¤„ç†: `src/components/VideoPlayer.tsx` ç¬¬ 61-75 è¡Œ
- ä»£ç†æœåŠ¡å™¨: `src-tauri/src/lib.rs` ç¬¬ 490-580 è¡Œ
- URL é‡å†™é€»è¾‘: `src-tauri/src/lib.rs` ç¬¬ 545-575 è¡Œ

### 2. HLS.js é…ç½®ä¼˜åŒ–

å®Œå…¨å‚è€ƒ **x-iptv-player** é¡¹ç›®çš„æœ€ä½³å®è·µï¼š

```typescript
{
  // è¶…æ—¶é…ç½®ï¼ˆå¤§å¹…å¢åŠ ï¼‰
  fragLoadingTimeOut: 60000,        // 60 ç§’
  manifestLoadingTimeOut: 30000,    // 30 ç§’
  levelLoadingTimeOut: 30000,       // 30 ç§’

  // é‡è¯•é…ç½®ï¼ˆå¢åŠ æ¬¡æ•°ï¼‰
  manifestLoadingMaxRetry: 6,       // 6 æ¬¡
  levelLoadingMaxRetry: 6,          // 6 æ¬¡
  fragLoadingMaxRetry: 8,           // 8 æ¬¡

  // Buffer é…ç½®ï¼ˆå¤§å®¹é‡ï¼‰
  maxBufferLength: 30,              // 30 ç§’å‰å‘ç¼“å†²
  maxMaxBufferLength: 60,           // 60 ç§’æœ€å¤§ç¼“å†²
  backBufferLength: 30,             // 30 ç§’åå‘ç¼“å†²
  maxBufferSize: 120 * 1000 * 1000, // 120 MB

  // ç¨³å®šæ€§ä¼˜å…ˆ
  lowLatencyMode: false,            // å…³é—­ä½å»¶è¿Ÿæ¨¡å¼
  enableSoftwareAES: true,          // å¯ç”¨è½¯ä»¶ AES è§£å¯†
}
```

### 3. æ™ºèƒ½é”™è¯¯å¤„ç†

**é”™è¯¯è¿‡æ»¤æœºåˆ¶ï¼š**
- å¿½ç•¥éè‡´å‘½é”™è¯¯ï¼ˆ`fragLoadTimeOut`ã€`fragLoadError` ç­‰ï¼‰
- è®© HLS.js çš„å†…ç½®é‡è¯•æœºåˆ¶ä¼˜å…ˆå·¥ä½œ
- åªåœ¨çœŸæ­£è‡´å‘½é”™è¯¯æ—¶äººå·¥å¹²é¢„

**æŒ‡æ•°é€€é¿é‡è¯•ï¼š**
```
1s â†’ 2s â†’ 4s â†’ 8sï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
```

**é”™è¯¯æ¢å¤ç­–ç•¥ï¼š**
- ç½‘ç»œé”™è¯¯ â†’ `hls.startLoad()`
- åª’ä½“é”™è¯¯ â†’ `hls.recoverMediaError()`
- å…¶ä»–é”™è¯¯ â†’ é‡æ–°åŠ è½½

### 4. ä»£ç†æœåŠ¡å™¨å®ç°

**æŠ€æœ¯é€‰å‹ï¼š**
- ä½¿ç”¨ **Axum** æ¡†æ¶ï¼ˆé«˜æ€§èƒ½ã€å¼‚æ­¥ï¼‰
- ç«¯å£ï¼š`127.0.0.1:18080`ï¼ˆå›ºå®šç«¯å£ï¼Œé¿å…å†²çªï¼‰
- æ”¯æŒ CORS è·¨åŸŸè¯·æ±‚

**è¯·æ±‚å¤´æ³¨å…¥ï¼š**
```rust
.header("User-Agent", "Mozilla/5.0...")
.header("Accept", "*/*")
.header("Referer", "https://www.example.com/")
.header("Cache-Control", "no-cache")
```

**m3u8 URL é‡å†™ç®—æ³•ï¼š**
1. è§£æ base URL
2. éå†æ¯ä¸€è¡Œ
3. ç›¸å¯¹è·¯å¾„ â†’ ç»å¯¹è·¯å¾„
4. IPv6 URL â†’ ä»£ç† URLï¼ˆ`http://127.0.0.1:18080/proxy?url=...`ï¼‰
5. è¿”å›å¤„ç†åçš„å†…å®¹

## ğŸ”§ æ•…éšœæ’é™¤

### 1. æ’­æ”¾ 1 åˆ†é’Ÿååœæ­¢

**å·²ä¿®å¤ï¼** ä¹‹å‰çš„é—®é¢˜åŸå› ï¼š
- âŒ ä½¿ç”¨ Blob URLï¼ˆé™æ€ï¼Œä¸ä¼šæ›´æ–°ï¼‰
- âŒ æ’­æ”¾è¿›åº¦ç›‘æ§å¹²é¢„ï¼ˆæ¯ 5 ç§’æ£€æŸ¥å¹¶é‡æ–°åŠ è½½ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**
- âœ… ç›´æ¥ä½¿ç”¨ä»£ç† URLï¼ˆåŠ¨æ€ï¼ŒHLS.js ä¼šå®šæ—¶åˆ·æ–°ï¼‰
- âœ… ç§»é™¤æ‰€æœ‰æ’­æ”¾ç›‘æ§é€»è¾‘ï¼ˆè®© HLS.js è‡ªå·±å¤„ç†ï¼‰
- âœ… å‚è€ƒ x-iptv-player çš„ç®€æ´å®ç°

### 2. IPv6 URL æ— æ³•æ’­æ”¾

**ç—‡çŠ¶ï¼š** æ’­æ”¾æŒ‰é’®æ— ååº”æˆ–ç«‹å³æŠ¥é”™

**è§£å†³æ­¥éª¤ï¼š**
1. æ£€æŸ¥ä»£ç†æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ï¼š
   ```bash
   lsof -i:18080  # åº”è¯¥çœ‹åˆ° tauri-app è¿›ç¨‹
   ```
2. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   ğŸŒ æ£€æµ‹åˆ° IPv6 m3u8ï¼Œç›´æ¥é€šè¿‡ä»£ç†è®¿é—®
   ğŸ”„ ä»£ç† URL: http://127.0.0.1:18080/proxy?url=...
   ```
3. æ£€æŸ¥ Rust æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   ğŸš€ å¯åŠ¨ä»£ç†æœåŠ¡å™¨: http://127.0.0.1:18080
   ğŸŒ ä»£ç†è¯·æ±‚: http://[2409:8087:...]
   ğŸ“„ å¤„ç† m3u8 å†…å®¹ï¼ŒåŸå§‹å¤§å°: 1520 å­—èŠ‚
   ğŸ”„ é‡å†™ URL: http://[2409:8087:...] -> ä»£ç†
   âœ… ä»£ç†æˆåŠŸ: 7153024 å­—èŠ‚, ç±»å‹: video/MP2T
   ```

### 3. HLS æ’­æ”¾é—®é¢˜

å¦‚æœè§†é¢‘æ— æ³•æ’­æ”¾:
1. æ£€æŸ¥ M3U8 åœ°å€æ˜¯å¦æœ‰æ•ˆï¼ˆå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æµ‹è¯•ï¼‰
2. ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
4. æŸ¥çœ‹ Rust åç«¯æ—¥å¿—ï¼ˆç»ˆç«¯è¾“å‡ºï¼‰
5. å°è¯•ä½¿ç”¨æµ‹è¯• URLï¼š
   ```
   https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8
   ```

### 4. æ‰“åŒ…é—®é¢˜

å¦‚æœæ‰“åŒ…å¤±è´¥:
1. ç¡®ä¿ Rust ç¯å¢ƒæ­£ç¡®å®‰è£…: `rustc --version`
2. æ›´æ–° Tauri CLI: `cargo install tauri-cli --force`
3. æ¸…ç†ç¼“å­˜: `cargo clean && npm run tauri build`
4. æ£€æŸ¥ä¾èµ–: `cargo check`

### 5. ç«¯å£å†²çªï¼ˆ1420 æˆ– 18080ï¼‰

**Vite ç«¯å£å†²çªï¼ˆ1420ï¼‰ï¼š**
```bash
lsof -ti:1420 | xargs kill -9
npm run tauri dev
```

**ä»£ç†æœåŠ¡å™¨ç«¯å£å†²çªï¼ˆ18080ï¼‰ï¼š**
```bash
lsof -ti:18080 | xargs kill -9
# ä¿®æ”¹ src-tauri/src/lib.rs ä¸­çš„ç«¯å£å·
```

## ğŸ‘¨â€ğŸ’» å¼€å‘è€…æŒ‡å—

### ä¿®æ”¹ä»£ç†æœåŠ¡å™¨ç«¯å£

å¦‚æœ 18080 ç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ `src-tauri/src/lib.rs`ï¼š

```rust
// ç¬¬ 599 è¡Œé™„è¿‘
let addr = std::net::SocketAddr::from(([127, 0, 0, 1], 18080)); // æ”¹ä¸ºå…¶ä»–ç«¯å£
```

åŒæ—¶ä¿®æ”¹å‰ç«¯ `src/components/VideoPlayer.tsx`ï¼š

```typescript
// ç¬¬ 73 è¡Œé™„è¿‘
processedUrl = `http://127.0.0.1:18080/proxy?url=${encodedUrl}`; // æ”¹ä¸ºå¯¹åº”ç«¯å£
```

### è°ƒè¯•æŠ€å·§

**1. æŸ¥çœ‹ä»£ç†æœåŠ¡å™¨æ—¥å¿—ï¼š**
```bash
# å¯åŠ¨ dev æ¨¡å¼ï¼Œæ—¥å¿—ä¼šç›´æ¥è¾“å‡ºåˆ°ç»ˆç«¯
npm run tauri dev

# åº”è¯¥çœ‹åˆ°ï¼š
# ğŸš€ å¯åŠ¨ä»£ç†æœåŠ¡å™¨: http://127.0.0.1:18080
# ğŸŒ ä»£ç†è¯·æ±‚: http://[2409:8087:...]
# ğŸ“„ å¤„ç† m3u8 å†…å®¹ï¼ŒåŸå§‹å¤§å°: 1520 å­—èŠ‚
# âœ… ä»£ç†æˆåŠŸ: 7153024 å­—èŠ‚, ç±»å‹: video/MP2T
```

**2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼š**
```
å³é”® â†’ æ£€æŸ¥ â†’ Console æ ‡ç­¾

åº”è¯¥çœ‹åˆ°ï¼š
ğŸŒ æ£€æµ‹åˆ° IPv6 m3u8ï¼Œç›´æ¥é€šè¿‡ä»£ç†è®¿é—®
ğŸ”„ ä»£ç† URL: http://127.0.0.1:18080/proxy?url=...
========== HLSæ’­æ”¾å™¨åˆå§‹åŒ–å¼€å§‹ ==========
HLSæ¸…å•è§£æå®Œæˆ: {...}
```

**3. æµ‹è¯•ä»£ç†æœåŠ¡å™¨ï¼š**
```bash
# ç¡®è®¤ä»£ç†æœåŠ¡å™¨åœ¨è¿è¡Œ
lsof -i:18080

# æ‰‹åŠ¨æµ‹è¯•ä»£ç†
curl "http://127.0.0.1:18080/proxy?url=https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"
```

### æ·»åŠ æ–°çš„ Tauri å‘½ä»¤

1. åœ¨ `src-tauri/src/lib.rs` ä¸­å®šä¹‰å‘½ä»¤ï¼š
   ```rust
   #[tauri::command]
   async fn my_command(param: String) -> Result<String, String> {
       Ok(format!("Hello {}", param))
   }
   ```

2. æ³¨å†Œå‘½ä»¤ï¼š
   ```rust
   .invoke_handler(tauri::generate_handler![
       get_sources,
       add_source,
       my_command  // æ·»åŠ è¿™é‡Œ
   ])
   ```

3. å‰ç«¯è°ƒç”¨ï¼š
   ```typescript
   import { invoke } from "@tauri-apps/api/core";

   const result = await invoke<string>("my_command", { param: "World" });
   ```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

**1. HLS.js å‚æ•°è°ƒä¼˜ï¼š**
- ç½‘ç»œå¥½ï¼šå‡å°‘ `maxBufferLength` åˆ° 10-15 ç§’
- ç½‘ç»œå·®ï¼šå¢åŠ è¶…æ—¶æ—¶é—´å’Œé‡è¯•æ¬¡æ•°
- ä½é…è®¾å¤‡ï¼šå‡å°‘ `maxBufferSize`

**2. ä»£ç†æœåŠ¡å™¨ä¼˜åŒ–ï¼š**
- å¢åŠ è¶…æ—¶æ—¶é—´ï¼š`timeout(std::time::Duration::from_secs(60))`
- å¯ç”¨è¿æ¥æ± ï¼š`pool_max_idle_per_host(10)`
- å¯ç”¨ HTTP/2ï¼š`http2_prior_knowledge()`

**3. å‰ç«¯ä¼˜åŒ–ï¼š**
- ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨ï¼ˆå¤§é¢‘é“åˆ—è¡¨ï¼‰
- æ‡’åŠ è½½é¢‘é“ logo
- ç¼“å­˜è®¢é˜…æºæ•°æ®

## ğŸ› å·²çŸ¥é—®é¢˜

### 1. ~~æ’­æ”¾ 1 åˆ†é’Ÿåè‡ªåŠ¨åœæ­¢~~ âœ… å·²ä¿®å¤
**åŸå› ï¼š** ä½¿ç”¨äº†é™æ€ Blob URLï¼Œm3u8 ä¸ä¼šæ›´æ–°
**è§£å†³ï¼š** æ”¹ç”¨åŠ¨æ€ä»£ç† URLï¼Œè®© HLS.js å®šæ—¶åˆ·æ–°

### 2. ~~IPv6 URL æ— æ³•æ’­æ”¾~~ âœ… å·²ä¿®å¤
**åŸå› ï¼š** .ts ç‰‡æ®µ URL æœªé€šè¿‡ä»£ç†
**è§£å†³ï¼š** åœ¨ä»£ç†æœåŠ¡å™¨ä¸­é‡å†™ m3u8 å†…å®¹ï¼Œå°†æ‰€æœ‰ URL è½¬ä¸ºä»£ç† URL

### 3. macOS æ‰“åŒ…åé¦–æ¬¡è¿è¡Œæç¤º"å·²æŸå"
**åŸå› ï¼š** macOS Gatekeeper å®‰å…¨æ£€æŸ¥
**è§£å†³ï¼š**
```bash
# ç§»é™¤æ‰©å±•å±æ€§
xattr -cr /Applications/IPTV\ Player.app

# æˆ–åœ¨ç³»ç»Ÿè®¾ç½®ä¸­å…è®¸
ç³»ç»Ÿè®¾ç½® â†’ éšç§ä¸å®‰å…¨æ€§ â†’ ä»è¦æ‰“å¼€
```

## ğŸ“š å‚è€ƒèµ„æ–™

- [Tauri å®˜æ–¹æ–‡æ¡£](https://tauri.app/)
- [HLS.js GitHub](https://github.com/video-dev/hls.js)
- [Axum æ–‡æ¡£](https://docs.rs/axum/)
- [Reqwest æ–‡æ¡£](https://docs.rs/reqwest/)
- [x-iptv-player é¡¹ç›®](https://github.com/xxx/x-iptv-player) - æœ¬é¡¹ç›®çš„çµæ„Ÿæ¥æº

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-01-25)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒ M3U/M3U8 æ’­æ”¾åˆ—è¡¨
- âœ… HLS ç›´æ’­æµæ’­æ”¾
- âœ… macOS DMG æ‰“åŒ…

### v1.1.0 (2025-01-25)
- âœ… å®Œç¾æ”¯æŒ IPv6 URL
- âœ… å†…ç½® HTTP ä»£ç†æœåŠ¡å™¨ï¼ˆAxumï¼‰
- âœ… æ™ºèƒ½ m3u8 URL é‡å†™
- âœ… ä¿®å¤æ’­æ”¾ 1 åˆ†é’Ÿååœæ­¢çš„é—®é¢˜
- âœ… ä¼˜åŒ– HLS.js é…ç½®ï¼ˆè¶…æ—¶ã€é‡è¯•ã€bufferï¼‰
- âœ… æ™ºèƒ½é”™è¯¯è¿‡æ»¤å’Œè‡ªåŠ¨æ¢å¤
- âœ… æ•°æ®æŒä¹…åŒ–

## ğŸ“Š æ—¥å¿—ç³»ç»Ÿ

### æ¦‚è¿°

é¡¹ç›®é›†æˆäº†ç”Ÿäº§çº§æ—¥å¿—ç³»ç»Ÿï¼Œä½¿ç”¨ Rust çš„ `tracing` æ¡†æ¶å®ç°ï¼š
- âœ… æ–‡ä»¶æ—¥å¿—ï¼ˆæ¯æ—¥æ»šåŠ¨ï¼‰
- âœ… æ§åˆ¶å°æ—¥å¿—ï¼ˆå¸¦é¢œè‰²ï¼‰
- âœ… ç»“æ„åŒ–æ—¥å¿—è®°å½•
- âœ… å‡½æ•°è°ƒç”¨è‡ªåŠ¨è¿½è¸ª
- âœ… å¤šçº§åˆ«æ—¥å¿—ï¼ˆERROR, WARN, INFO, DEBUG, TRACEï¼‰

### æ—¥å¿—æ–‡ä»¶ä½ç½®

**macOS:**
```bash
~/Library/Logs/com.sai.iptv-player/iptv-player.log.YYYY-MM-DD
```

**æ³¨æ„ï¼š** æ—¥å¿—æ–‡ä»¶åä¼šè‡ªåŠ¨æ·»åŠ æ—¥æœŸåç¼€ï¼ˆå¦‚ `iptv-player.log.2025-10-25`ï¼‰ï¼Œè¿™æ˜¯ `tracing-appender` çš„æ—¥æœŸæ»šåŠ¨ç­–ç•¥ï¼Œ**è¿™æ˜¯æ­£å¸¸è¡Œä¸º**ã€‚æ¯å¤©åˆå¤œä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚

**Windows:**
```bash
%APPDATA%\com.sai.iptv-player\logs\iptv-player.log.YYYY-MM-DD
```

**Linux:**
```bash
~/.local/share/com.sai.iptv-player/logs/iptv-player.log.YYYY-MM-DD
```

### å¿«é€Ÿä½¿ç”¨

**1. å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆæ¨èï¼‰ï¼š**
```bash
# macOS/Linux - ä½¿ç”¨é€šé…ç¬¦è‡ªåŠ¨åŒ¹é…æœ€æ–°æ—¥å¿—
tail -f ~/Library/Logs/com.sai.iptv-player/iptv-player.log.*

# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
cat ~/Library/Logs/com.sai.iptv-player/*.log.*

# æœç´¢é”™è¯¯
grep -E "ERROR|WARN" ~/Library/Logs/com.sai.iptv-player/*.log.*
```

**å¿«æ·åˆ«åï¼ˆæ¨èï¼‰ï¼š**
```bash
# æ·»åŠ åˆ° ~/.zshrc æˆ– ~/.bashrc
echo 'alias iptv-log="tail -f ~/Library/Logs/com.sai.iptv-player/iptv-player.log.*"' >> ~/.zshrc
echo 'alias iptv-errors="grep -E \"ERROR|WARN\" ~/Library/Logs/com.sai.iptv-player/*.log.*"' >> ~/.zshrc
source ~/.zshrc

# ä½¿ç”¨
iptv-log        # å®æ—¶æŸ¥çœ‹æ—¥å¿—
iptv-errors     # æŸ¥çœ‹é”™è¯¯æ—¥å¿—
```

**2. è®¾ç½®æ—¥å¿—çº§åˆ«ï¼š**
```bash
# é»˜è®¤ INFO çº§åˆ«
npm run tauri dev

# DEBUG çº§åˆ«ï¼ˆæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼‰
export RUST_LOG=debug
npm run tauri dev

# TRACE çº§åˆ«ï¼ˆæœ€è¯¦ç»†ï¼‰
export RUST_LOG=trace
npm run tauri dev
```

**3. ä»ç»ˆç«¯å¯åŠ¨å·²å®‰è£…åº”ç”¨ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰ï¼š**
```bash
# macOS
/Applications/IPTV\ Player.app/Contents/MacOS/IPTV\ Player

# è®¾ç½®æ—¥å¿—çº§åˆ«
export RUST_LOG=debug
/Applications/IPTV\ Player.app/Contents/MacOS/IPTV\ Player
```

### æ—¥å¿—ç¤ºä¾‹

**åº”ç”¨å¯åŠ¨ï¼ˆå®é™…æ—¥å¿—ï¼‰ï¼š**
```
2025-10-25T19:59:07Z  INFO æ—¥å¿—ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ
2025-10-25T19:59:07Z  INFO æ—¥å¿—æ–‡ä»¶ä½ç½®: "/Users/sai/Library/Logs/com.sai.iptv-player/iptv-player.log"
2025-10-25T19:59:07Z  INFO ========================================
2025-10-25T19:59:07Z  INFO IPTV Player å¯åŠ¨
2025-10-25T19:59:07Z  INFO ç‰ˆæœ¬: 0.1.0
2025-10-25T19:59:07Z  INFO ========================================
2025-10-25T19:59:07Z  INFO å¯åŠ¨ HTTP ä»£ç†æœåŠ¡å™¨: http://127.0.0.1:18080
2025-10-25T19:59:08Z  INFO æ•°æ®ç›®å½•: "/Users/sai/Library/Application Support/com.sai.iptv-player"
2025-10-25T19:59:08Z  INFO ä»æ–‡ä»¶åŠ è½½äº† 3 ä¸ªè®¢é˜…æº
2025-10-25T19:59:08Z  INFO åº”ç”¨åˆå§‹åŒ–å®Œæˆ
```

**æ·»åŠ è®¢é˜…æºï¼š**
```
INFO æ·»åŠ è®¢é˜…æº: åç§°='CCTV', URLç±»å‹='ç½‘ç»œåœ°å€'
INFO M3U å†…å®¹ä¸‹è½½æˆåŠŸï¼Œå¤§å°: 12345 å­—èŠ‚
INFO æˆåŠŸè§£æ 123 ä¸ªé¢‘é“
```

**HTTP ä»£ç†ï¼š**
```
DEBUG HTTP ä»£ç†è¯·æ±‚
INFO HTTP ä»£ç†æˆåŠŸ: 6789 å­—èŠ‚
```

### æ—¥å¿—çº§åˆ«è¯´æ˜

| çº§åˆ« | ç¯å¢ƒå˜é‡ | ç”¨é€” | é€‚ç”¨åœºæ™¯ |
|------|---------|------|---------|
| ERROR | `RUST_LOG=error` | ä»…é”™è¯¯ | ç”Ÿäº§ç¯å¢ƒ |
| WARN | `RUST_LOG=warn` | è­¦å‘Š+é”™è¯¯ | ç”Ÿäº§ç¯å¢ƒ |
| INFO | `RUST_LOG=info` | å…³é”®æ“ä½œ | é»˜è®¤/ç”Ÿäº§ |
| DEBUG | `RUST_LOG=debug` | è¯¦ç»†ä¿¡æ¯ | å¼€å‘/è°ƒè¯• |
| TRACE | `RUST_LOG=trace` | å®Œæ•´è¿½è¸ª | æ·±åº¦è°ƒè¯• |

### è°ƒè¯•æŠ€å·§

**è°ƒè¯•è®¢é˜…æºæ·»åŠ å¤±è´¥ï¼š**
```bash
export RUST_LOG=debug
tail -f ~/Library/Logs/com.sai.iptv-player/iptv-player.log.* | grep "è®¢é˜…æº\|M3U\|è§£æ"
```

**è°ƒè¯•æ’­æ”¾å¤±è´¥ï¼š**
```bash
tail -f ~/Library/Logs/com.sai.iptv-player/iptv-player.log.* | grep "ä»£ç†\|proxy"
```

**è°ƒè¯• IPv6 é—®é¢˜ï¼š**
```bash
tail -f ~/Library/Logs/com.sai.iptv-player/iptv-player.log.* | grep "IPv6\|ipv6"
```

### æ¸…ç†æ—¥å¿—

```bash
# åˆ é™¤ 7 å¤©å‰çš„æ—¥å¿—
find ~/Library/Logs/com.sai.iptv-player -name "iptv-player.log.*" -mtime +7 -delete

# åˆ é™¤æ‰€æœ‰å†å²æ—¥å¿—ï¼ˆä¿ç•™å½“å‰ï¼‰
rm ~/Library/Logs/com.sai.iptv-player/iptv-player.log.*
```

### å®Œæ•´æ–‡æ¡£

è¯¦ç»†ä½¿ç”¨æŒ‡å—è¯·æŸ¥çœ‹ **[LOGGING.md](./LOGGING.md)**ï¼ŒåŒ…å«ï¼š
- å„å¹³å°æ—¥å¿—ä½ç½®è¯¦è§£
- é«˜çº§è¿‡æ»¤å’Œæœç´¢æŠ€å·§
- ç¯å¢ƒå˜é‡é…ç½®æ–¹æ³•
- é—®é¢˜æŠ¥å‘ŠæŒ‡å—
- å¸¸è§é—®é¢˜è§£ç­”

## ğŸ“ License

MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ”¹åŠ¨ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### ä»£ç è§„èŒƒ

- **Rust**: ä½¿ç”¨ `cargo fmt` æ ¼å¼åŒ–ä»£ç 
- **TypeScript**: ä½¿ç”¨ Prettier æ ¼å¼åŒ–
- **æäº¤ä¿¡æ¯**: ä½¿ç”¨æ¸…æ™°çš„ä¸­æ–‡æˆ–è‹±æ–‡æè¿°

## ğŸ’¬ è”ç³»æ–¹å¼

- Issue Tracker: [GitHub Issues](https://github.com/yourusername/iptv-player/issues)
- é‚®ç®±: your.email@example.com

## ğŸ™ è‡´è°¢

- [Tauri](https://tauri.app/) - ä¼˜ç§€çš„æ¡Œé¢åº”ç”¨æ¡†æ¶
- [HLS.js](https://github.com/video-dev/hls.js) - å¼ºå¤§çš„ HLS æ’­æ”¾å™¨
- [x-iptv-player](https://github.com/xxx/x-iptv-player) - æŠ€æœ¯å‚è€ƒå’Œçµæ„Ÿæ¥æº
- [Axum](https://github.com/tokio-rs/axum) - é«˜æ€§èƒ½ HTTP æ¡†æ¶

---

**Enjoy! ğŸ“º**

å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿æ Issue æˆ–æŸ¥çœ‹ [æ•…éšœæ’é™¤](#ğŸ”§-æ•…éšœæ’é™¤) éƒ¨åˆ†ã€‚